# Test Program: System Operations
# Tests: NOP, HALT, ECALL (if implemented)
# Coverage: Pipeline timing, no-operation behavior, system control

# ============================================================
# Test 1: NOP Does Not Modify State
# ============================================================
# NOP should advance PC but change nothing else
#
    LDI R1, 5           # R1 = 5
    LDI R2, 7           # R2 = 7
    NOP                 # Should do nothing
    NOP                 # Should do nothing
    NOP                 # Should do nothing
    # Verify R1 and R2 unchanged
    SUB R3, R1, R2      # R3 = R1 - R2 = 5 - 7 = -2
    # R3 should be -2 (negative)

# ============================================================
# Test 2: NOP in Pipeline (Hazard Scenarios)
# ============================================================
# NOP should work correctly between dependent instructions
#
    LDI R4, 1           # R4 = 1
    NOP                 # Delay slot
    ADD R5, R4, R4      # R5 = R4 + R4 = 2 (after NOP)
    NOP                 # Another delay
    NOP                 # More delay
    ADD R6, R5, R4      # R6 = R5 + R4 = 3

# ============================================================
# Test 3: NOP Count Verification
# ============================================================
# Use NOPs as timing delays, verify instruction count
#
    LDI R7, 0           # R7 = 0 (counter)
    ADD R7, R7, R4      # R7 = 1 (R4 is still 1)
    NOP
    ADD R7, R7, R4      # R7 = 2
    NOP
    NOP
    ADD R7, R7, R4      # R7 = 3
    NOP
    NOP
    NOP
    ADD R7, R7, R4      # R7 = 4
    # R7 should equal 4

# ============================================================
# Test 4: NOP Before Branch
# ============================================================
# Ensure NOP doesn't affect branch behavior
#
    LDI R1, 1
    LDI R2, 1
    NOP
    BEQ R1, R2, nop_branch_ok  # Should branch (1 == 1)
    LDI R8, -1          # Should be SKIPPED
nop_branch_ok:
    LDI R8, 1           # R8 = 1 (branch worked after NOP)

# ============================================================
# Test 5: Multiple NOPs Between Operations
# ============================================================
# Stress test: many NOPs in sequence
#
    LDI R1, 10          # R1 = 10 (using as base)
    NOP
    NOP
    NOP
    NOP
    NOP                 # 5 NOPs
    SUB R2, R1, R7      # R2 = R1 - R7 = 10 - 4 = 6
    # R2 should be 6

# ============================================================
# Validation Summary
# ============================================================
# Expected final register state:
# R1 = 10
# R2 = 6
# R3 = -2 (negative)
# R4 = 1
# R5 = 2
# R6 = 3
# R7 = 4
# R8 = 1

    HALT
